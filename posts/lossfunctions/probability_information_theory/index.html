<!doctype html><html lang=zh data-theme><head><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><title>Book Notes: Probability and Information Theory - fgg blog</title>
<meta name=description content="

    
        ##
    
    Probability and Information Theory


Probability theory is a mathematical framework for representing uncertain statements. It provides a means of quantifying uncertainty as well as axioms (公理) for deriving new uncertain statements. In artificial intelligence applications, we use probability theory in two major ways:

The laws of probability tell us how AI systems should reason, so we design our algorithms to compute or approximate various expressions derived using probability theory;
We can use probability and statistics to theoretically analyze the behavior of proposed AI systems.

While probability theory allows us to make uncertain statements and to reason in the presence of uncertainty, information theory enables us to quantify the amount of uncertainty in a probability distribution."><link rel=icon type=image/x-icon href=https://fgg100y.github.io/favicon.ico><link rel=apple-touch-icon-precomposed href=https://fgg100y.github.io/favicon.png><style>body{visibility:hidden;opacity:0}</style><noscript><style>body{visibility:visible;opacity:1}</style></noscript><link rel=stylesheet href=/css/style.min.184a655c5ad8596648622468e6696abf0cf0a2cf8266df17b4f7a36fe9c97551.css integrity="sha256-GEplXFrYWWZIYiRo5mlqvwzwos+CZt8XtPejb+nJdVE="><link rel=stylesheet href=/css/style.min.c4c04b3ef88e3d619ad4c7ee5e03048422bc55c4fefdc1f07657c1133670aa22.css integrity="sha256-xMBLPviOPWGa1MfuXgMEhCK8VcT+/cHwdlfBEzZwqiI="><link rel=stylesheet href=/css/style.min.21c5d8fe0a79d623b0adc1ce4bd4f6dd2c05cd939c9aaaa966ba7186b1464f4d.css integrity="sha256-IcXY/gp51iOwrcHOS9T23SwFzZOcmqqpZrpxhrFGT00="><link rel=stylesheet href=/css/style.min.863b4356f5ce53525ab2482f84c47476c4618984b9726e576c244225ebda1bcc.css integrity="sha256-hjtDVvXOU1JaskgvhMR0dsRhiYS5cm5XbCRCJevaG8w=" crossorigin=anonymous><script src=/js/script.min.08f04d96386c73c9bf4d160333f8f448c05a6e01c06770542ee0e013954ce930.js type=text/javascript integrity="sha256-CPBNljhsc8m/TRYDM/j0SMBabgHAZ3BULuDgE5VM6TA="></script><link rel=stylesheet href=/css/custom.css></head><body><a class=skip-main href=#main></a><div class=container><header class=common-header><div class=header-top><div class=header-top-left><h1 class="site-title noselect"><a href=/>fgg blog</a></h1><div class=theme-switcher><span class=inline-svg><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-sun-high"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14.828 14.828A4 4 0 109.172 9.172a4 4 0 005.656 5.656z"/><path d="M6.343 17.657l-1.414 1.414"/><path d="M6.343 6.343 4.929 4.929"/><path d="M17.657 6.343l1.414-1.414"/><path d="M17.657 17.657l1.414 1.414"/><path d="M4 12H2"/><path d="M12 4V2"/><path d="M20 12h2"/><path d="M12 20v2"/></svg></span></div><script>const STORAGE_KEY="user-color-scheme",defaultTheme="auto";let currentTheme,switchButton,autoDefinedScheme=window.matchMedia("(prefers-color-scheme: dark)");function switchTheme(){currentTheme=currentTheme==="dark"?"light":"dark",localStorage&&localStorage.setItem(STORAGE_KEY,currentTheme),document.documentElement.setAttribute("data-theme",currentTheme),changeGiscusTheme(currentTheme),document.body.dispatchEvent(new CustomEvent(currentTheme+"-theme-set"))}const autoChangeScheme=e=>{currentTheme=e.matches?"dark":"light",document.documentElement.setAttribute("data-theme",currentTheme),changeGiscusTheme(currentTheme),document.body.dispatchEvent(new CustomEvent(currentTheme+"-theme-set"))};document.addEventListener("DOMContentLoaded",function(){switchButton=document.querySelector(".theme-switcher"),currentTheme=detectCurrentScheme(),currentTheme==="auto"?(autoChangeScheme(autoDefinedScheme),autoDefinedScheme.addListener(autoChangeScheme)):document.documentElement.setAttribute("data-theme",currentTheme),switchButton&&switchButton.addEventListener("click",switchTheme,!1),showContent()});function detectCurrentScheme(){return localStorage!==null&&localStorage.getItem(STORAGE_KEY)?localStorage.getItem(STORAGE_KEY):defaultTheme?defaultTheme:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function showContent(){document.body.style.visibility="visible",document.body.style.opacity=1}function changeGiscusTheme(e){function t(e){const t=document.querySelector("iframe.giscus-frame");if(!t)return;t.contentWindow.postMessage({giscus:e},"https://giscus.app")}t({setConfig:{theme:e}})}</script><ul class="social-icons noselect"><li><a href=https://github.com/FGG100y title=Github rel=me><span class=inline-svg><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-github"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></span></a></li><li><a href=/index.xml title=RSS rel=me><span class=inline-svg><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></span></a></li></ul></div><div class=header-top-right></div></div><nav class=noselect><a href=https://fgg100y.github.io/ title>首页</a>
<a href=https://fgg100y.github.io/posts/ title>归档</a>
<a href=https://fgg100y.github.io/tags/ title>标签</a>
<a href=https://fgg100y.github.io/about/ title>关于</a></nav><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></header><main id=main tabindex=-1><article class="post h-entry"><div class=post-header><header><h1 class="p-name post-title">Book Notes: Probability and Information Theory</h1></header><div class="post-info noselect"><div class="post-date dt-published"><time datetime=2020-08-07>2020-08-07</time></div><a class="post-hidden-url u-url" href=/posts/lossfunctions/probability_information_theory/>/posts/lossfunctions/probability_information_theory/</a>
<a href=https://fgg100y.github.io/ class="p-name p-author post-hidden-author h-card" rel=me>map[email:1522009317@qq.com name:fmh]</a><div class=post-taxonomies><ul class=post-tags><li><a href=/tags/rv/>#RV</a></li><li><a href=/tags/pmf/pdf/>#PMF/PDF</a></li><li><a href=/tags/chain-rule/>#Chain Rule</a></li><li><a href=/tags/distributions/>#Distributions</a></li><li><a href=/tags/entropy/>#Entropy</a></li><li><a href=/tags/kl-divergence/>#KL Divergence</a></li><li><a href=/tags/histogram/>#Histogram</a></li><li><a href=/tags/book-notes/>#Book Notes</a></li></ul></div></div></div><details class="toc noselect"><summary>Table of Contents</summary><div class=inner><nav id=TableOfContents><ul><li><a href=#why-probability>Why Probability?</a></li><li><a href=#random-variables>Random Variables</a></li><li><a href=#probability-distributions>Probability Distributions</a><ul><li><a href=#discrete-variables-and-probability-mass-functions-pmf>Discrete Variables and Probability Mass Functions (PMF)</a></li><li><a href=#continuous-variables-and-probability-density-functions-pdf>Continuous Variables and Probability Density Functions (PDF)</a></li><li><a href=#marginal-probability>Marginal Probability</a></li><li><a href=#conditional-probability>Conditional Probability</a></li><li><a href=#the-chain-rule-of-conditional-probability>The Chain Rule of Conditional Probability</a></li><li><a href=#independence-and-conditional-independence>Independence and Conditional Independence</a></li><li><a href=#expectation-variance-and-covariance>Expectation, Variance and Covariance</a></li><li><a href=#common-probability-distribution>Common Probability Distribution</a></li></ul></li><li><a href=#information-theory>Information Theory</a><ul><li><a href=#entropy>Entropy</a></li><li><a href=#kl-divergence>KL divergence</a></li><li><a href=#kl-散度>KL 散度</a></li></ul></li><li><a href=#density-estimation>Density Estimation</a><ul><li><a href=#histogram>Histogram</a></li><li><a href=#histogram-for-density-estimation>Histogram for density estimation</a></li></ul></li></ul></nav></div></details><script>var toc=document.querySelector(".toc");toc&&toc.addEventListener("click",function(){event.target.tagName!=="A"&&(event.preventDefault(),this.open?(this.open=!1,this.classList.remove("expanded")):(this.open=!0,this.classList.add("expanded")))})</script><div class="content e-content"><h1 id=probability-and-information-theory><div><a href=#probability-and-information-theory>##
</a>Probability and Information Theory</div></h1><p>Probability theory is a mathematical framework for representing uncertain statements. It provides a means of quantifying uncertainty as well as axioms (公理) for deriving new uncertain statements. In artificial intelligence applications, we use probability theory in two major ways:</p><ul><li>The laws of probability tell us how AI systems should reason, so we design our algorithms to compute or approximate various expressions derived using probability theory;</li><li>We can use probability and statistics to theoretically analyze the behavior of proposed AI systems.</li></ul><p><strong>While probability theory allows us to make uncertain statements and to reason in the presence of uncertainty, information theory enables us to quantify the amount of uncertainty in a probability distribution.</strong></p><h2 id=why-probability><div><a href=#why-probability>#
</a>Why Probability?</div></h2><p>Machine learning must aways deal with uncertain quantities and sometimes stochastic (nondeterministic) quantities. Uncertainty and stochasticity can arise from many sources. There are three possible sources of uncertainty:</p><ul><li>Inherent stochasticity in the system being modeled. For example, most interpretations of quantum mechanics describe the dynamics of subatomic particles as being probabilistic.</li><li>Incomplete observability. Even deterministic systems can appear stochastic when we cannot observe all the variables that drive the behavior of the system. For example, there are three doors, two doors lead to a goat while a third leads to a car. The show contestant was asked to choose among three doors and wins the prize. The outcome given the contestant&rsquo;s choice is deterministic, but from the contestant&rsquo;s point of view, the outcome is uncertain.</li><li>Incomplete modeling. When we use a model that must discard some of the information we have observed, the discarded information results in uncertainty in the model&rsquo;s predictions.</li></ul><p>While it should be clear that we need a means of representing and reasoning about uncertainty, it is not immediately obvious that probability theory can provide all the tools we want for AI applications. Probability theory was originally developed to analyze the frequencies of events. It is easy to see how probability theory can be used to study events like drawing a certain hand of cards in a poker game. These kinds of events are often repeatable. When we say that an outcome has a probability $p$ of occurring, it means that if we repeated the experiment (e.g., drawing a hand of cards, flipping a coin) infinitely many times, then proportion $p$ of the repetitions would result in that outcome. This kind of reasoning does not seem immediately applicable to propositions that are not repeatable. If a doctor analyzes a patient and says that the patient has a 40 percent chance of having the flu, this means something very different &ndash; we cannot make infinitely many replicas of the patient, nor is there any reason to believe that different replicas of the patient would present with the same symptoms yet have varying underlying conditions. In the case of the doctor diagnosing the patient, we use probability to represent a <strong>degree of belief</strong>, with $1$ indicating absolute certainty that the patient has the flu and $0$ indicating absolute certainty that the patient does not have the flu. The former kind of probability, related directly to the rates at which events occur, is known as <strong>frequentist probability</strong>, while the latter, related to qualitative levels of certainty, is known as <strong>Bayesian probability</strong>.</p><p>Probability can be seen as the extension of logic to deal with uncertainty. Logic provides a set of formal rules for determining what propositions (命题) are implied to be true or false given the assumption that some other set of propositions is true of false. Probability theory provides a set of formal rules for determining the likelihood of a proposition being true given the likelihood of other propositions.</p><h2 id=random-variables><div><a href=#random-variables>#
</a>Random Variables</div></h2><p>A <strong>random variable</strong> is a variable that can take on different values randomly. On its own, a random variable is just a description of the states that are possible; it must be coupled with probability distribution that specifies how likely each of these states are.</p><p><em>Quantitative</em> random variables may be discrete or continuous. This is not a hard-and-fast distinction, but it is a useful one. For a discrete variable, the values can only differ by fixed amounts. Family size is discrete. Two families can differ in size by 0 or 1 or 2, and so on. Nothing in between is possible. Age, on the other hand, is a continuous variable. This doesn&rsquo;t refer to the fact that a person is continuously getting older; it just means that the difference in age between two people can be arbitrarily small &ndash; a year, a month, a day, a hour, $\ldots$ And there are variables are <em>qualitative</em> : examples are marital status (single, married, widowed, divorced, separated) and employment status (employed, unemployed, not in the labor force). Finally, the terms <em>qualitative, quantitative, discrete</em>, and <em>continuous</em> are also used to describe data &ndash; qualitative data are collected on a qualitative variable, and so on.</p><p><img alt="random variables" src=./images/stats_random_variables.png></p><h2 id=probability-distributions><div><a href=#probability-distributions>#
</a>Probability Distributions</div></h2><p>A <strong>probability distribution</strong> is a description of how likely a random variable or set of random variables is to take on each of its possible states. The way we describe probability distributions depends on whether the variables are discrete or continuous.</p><h3 id=discrete-variables-and-probability-mass-functions-pmf><div><a href=#discrete-variables-and-probability-mass-functions-pmf>##
</a>Discrete Variables and Probability Mass Functions (PMF)</div></h3><p>A probability distribution over discrete variables may be described using a <strong>Probability Mass Functions (PMF)</strong>. We typically denote probability mass functions with a capital $P$. Often we associate each random variable with different probability mass function and the reader must infer which PMF to use based on the identity of the random variable, rather than on the name of the function; $P(\bf{x})$ is usually not the same as $P(\bf{y})$.</p><p>The PMF maps from a state of a random variable to the probability of that random variable taking on that state. The probability that $\mathbf{x} = x$ is denoted explicitly as $P(\mathbf{x}=x)$ or $P(x)$ in brevity, with a probability of $1$ indicating that $\mathbf{x} = x$ is certain and a probability of $0$ indicating that $\mathbf{x} = x$ is impossible. Sometimes we define a variable first, then use $\sim$ notation: $\mathbf{x} \sim P(\mathbf{x})$.</p><p>PMF can act on many variables at the same time. Such a probability distribution over many variables is known as a <strong>join probability distribution</strong>. $P(\mathbf{x} = x, \mathbf{y} = y)$ denotes the probability that $\mathbf{x}=x, \mathbf{y}=y$ simultaneously. We may also write $P(x, y)$ for brevity.</p><p>To be a PMF on a random variable $\bf{x}$, a function $P$ must satisfy the following properties:</p><ul><li>The domain of $P$ must be the set of all possible states of $\bf{x}$.</li><li>$\forall x \in \mathbf{x}, 0 \le P(x) \le 1$. An impossible event has probability $0$, and no state can be less probable than that. Likewise, an event that is guaranteed to happen has probability $1$, and no state can have a greater chance of occurring.</li><li>$\sum_{x \in \mathbf{x}} P(x) = 1$. We refer to this property as being <strong>normalized</strong>. Without this property, we could obtain probabilities greater than one by computing the probability of one of many events occurring.</li></ul><p>For example, consider a single discrete random variable $\bf{x}$ with $k$ different states. We can place a <strong>uniform distribution</strong> on $\bf{x}$ &ndash; that is, make each of its states equally likely &ndash; by setting its PMF to
$$
\tag{3.1}
P(\mathbf{x}=x_i) = {1 \over k}
$$
for all $i$. We can see that this fits the requirements for a probability mass function. The value $1 \over k$ is positive because $k$ is positive integer. We also see that
$$
\tag{3.2}
\sum_i P(\mathbf{x}=x_i) = \sum_i {1 \over k} = {k \over k} = 1,
$$
so the distribution is properly normalized.</p><h3 id=continuous-variables-and-probability-density-functions-pdf><div><a href=#continuous-variables-and-probability-density-functions-pdf>##
</a>Continuous Variables and Probability Density Functions (PDF)</div></h3><p>When working with continuous random variables, we describe probability distributions using a <strong>Probability Density Functions (PDF)</strong> rather than a PMF. To be a Probability Density Function, a function $p$ must satisfy the following properties:</p><ul><li>The domain of $p$ must be the set of all possible states of $\bf{x}$.</li><li>$\forall x \in \mathbf{x}, p(x) \ge 0$. Note that we do not require $p(x) \le 1$.</li><li>$\int p(x)dx = 1$.</li></ul><p><strong>A probability density function $p(x)$ does not give the probability of a specific state directly; instead the probability of landing inside an infinitesimal region with volume $\delta x$ is given by $p(x) \delta x$.</strong> Specifically, the probability that $x$ lies in some set $\mathbb{S}$ is given by the integral of density function $p(x)$ over that set. In the univariate example, the probability that $x$ lies in the interval $[a, b]$ is given by $\int_{[a, b]}p(x)dx$.</p><p>For an example of a PDF corresponding to a specific probability density over a continuous random variable, consider a uniform distribution on an interval of the real numbers. We can do this with a function $u(x; a, b)$, where $a$ and $b$ are the endpoints of the interval, with $b > a$. The &ldquo;$;$&rdquo; notation means &ldquo;parametrized by&rdquo;; we consider $x$ to be the argument of the function, while $a$ and $b$ are parameters that define the function. To ensure that there is no probability mass outside the interval, we say $u(x; a, b) = 0\ \text{for all}\ x \notin [a, b]$. Within $[a, b]$, $u(x; a, b) = {1 \over b-a}$. we can see that this is non-negative everywhere. Additionally, it integrates to $1$. We often denote that $x$ follows the uniform distribution on $[a, b]$ by writing $\mathbf{x} \sim U(a, b)$.</p><h3 id=marginal-probability><div><a href=#marginal-probability>##
</a>Marginal Probability</div></h3><p>Sometimes we know the probability distribution over a set of variables and we want to know the probability distribution over just a subset of them. The probability distribution over the subset is known as the <strong>marginal probability distribution</strong>.</p><p>For example, suppose we have discrete random variables $\bf{x}$ and $\bf{y}$ , and we know $P(\bf{x}, y)$. We can find $P(\bf{x})$ with <strong>sum rule</strong>:
$$
\tag{3.3}
\forall x \in \mathbf{x}, P(\mathbf{x} = x) = \sum_y P(\mathbf{x}=x, \mathbf{y}=y) .
$$
The name &ldquo;marginal probability&rdquo; comes from the process of computing marginal probabilities on paper. When the values of $P(\bf{x}, y)$ are written in a grid with different values of $x$ in rows and different values of $y$ in columns, it is natural to sum across a row of the grid, then write $P(\bf{x})$ in the marginal of the paper just to the right of the row (see Table 4.1 from the book [Doing Bayesian Data Analysis]).</p><p><img alt="discrete marginal probability" src=./images/DBDA_marginal_probability.png></p><p>For continuous variables, we need to use integration instead of summation:
$$
\tag{3.4}
p(x) = \int p(x, y)dy .
$$</p><h3 id=conditional-probability><div><a href=#conditional-probability>##
</a>Conditional Probability</div></h3><p>In many cases, we are interested in the probability of some event, given that some other event has happened. This is called a <strong>conditional probability</strong>. We denote the conditional probability that $\mathbf{y}=y$ given $\mathbf{x}=x$ as $P(\mathbf{y}=y | \mathbf{x}=x)$. This conditional probability can be computed with the formula
$$
\tag{3.5}
P(\mathbf{y}=y | \mathbf{x}=x) = \frac{P(\mathbf{y}=y , \mathbf{x}=x)}{P(\mathbf{x}=x)} .
$$
The conditional probability is only defined when $P(\mathbf{x}=x) > 0$. We cannot compute the conditional probability conditioned on an event that never happens.</p><p>It is important not to confuse conditional probability with computing what would happen if some action were undertaken. The conditional probability that a person is from Germany given that they speak German is quite high, but if a randomly selected person is taught to speak German, their country of origin does not change. Computing the consequences of an action is called making an <strong>intervention query</strong>. Intervention queries are the domain of <strong>causal modeling</strong>.</p><h3 id=the-chain-rule-of-conditional-probability><div><a href=#the-chain-rule-of-conditional-probability>##
</a>The Chain Rule of Conditional Probability</div></h3><p>Any join probability distribution over many random variables may be decomposed into conditional distribution over only one variable:
$$
\tag{3.6}
P(\mathbf{x}^{(1)}, \ldots, \mathbf{x}^{(n)}) = P(\mathbf{x}^{(1)}) \prod^n_{i=2} P(\mathbf{x}^{(i)} | \mathbf{x}^{(1)}, \ldots, \mathbf{x}^{(i-1)}) .
$$
This observation is known as the <strong>chain rule</strong>, or <strong>product rule</strong>, of probability. It follows immediately from the definition of conditional probability in equation 3.5.</p><p>For example, applying the definition twice, we get
$$
\begin{eqnarray}
P(a, b, c) &=& P(a | b, c) P(b, c) \
\
P(b, c) &=& P(b | c) P(c) \
\
P(a, b, c) &=& P(a | b, c) P(b | c) P(c) .
\end{eqnarray}
$$</p><h3 id=independence-and-conditional-independence><div><a href=#independence-and-conditional-independence>##
</a>Independence and Conditional Independence</div></h3><p>Two random variables $\bf{x}$ and $\bf{y}$ are <strong>independent</strong> if their probability distribution can be expressed as a product of two factors, one involving only $\bf{x}$ and one involving only $\bf{y}$ :
$$
\tag{3.7}
\forall x \in \mathbf{x}, y \in\mathbf{y}, p(\mathbf{x}=x, \mathbf{y}=y) = p(\mathbf{x}=x) p(\mathbf{y}=y) .
$$
Two random variables $\bf{x}$ and $\bf{y}$ are <strong>conditional independent</strong> given a random variable $z$ if the conditional probability distribution over $\bf{x}$ and $\bf{y}$ factorizes in this way for every value of $z$ :
$$
\tag{3.8}
\forall x \in \mathbf{x}, y \in\mathbf{y}, z \in \mathbf{z},
p(\mathbf{x}=x, \mathbf{y}=y | \mathbf{z}=z) =
p(\mathbf{x}=x | \mathbf{z}=z) p(\mathbf{y}=y | \mathbf{z}=z) .
$$
We can denote <strong>independent</strong> and <strong>conditional independent</strong> with compact notation:</p><ul><li>$\bf{x} \perp y$ means that $\bf{x}$ and $\bf{y}$ are independent,</li><li>$\bf{x} \perp y | z$ means that $\bf{x}$ and $\bf{y}$ are conditional independent given $z$.</li></ul><h3 id=expectation-variance-and-covariance><div><a href=#expectation-variance-and-covariance>##
</a>Expectation, Variance and Covariance</div></h3><p>The <strong>expectation</strong>, or <strong>expected value</strong>, of some function $f(x)$ with respect to a probability distribution $P(\mathbf{x})$ is the average, or mean value, that $f$ takes on when $x$ is drawn from $P$. For discrete variables this can be computed with summation:
$$
\tag{3.9}
\mathbb{E}<em>{\mathbf{x} \sim P} [f(x)] = \sum_x P(x)f(x),
$$
while for continuous variables, it is computed with an integral:
$$
\tag{3.10}
\mathbb{E}</em>{\mathbf{x} \sim P} [f(x)] = \int p(x)f(x)dx,
$$
Expectations are linear, for example,
$$
\tag{3.11}
\mathbb{E}<em>{\mathbf{x}} [\alpha f(x) + \beta g(x)] =
\alpha \mathbb{E}</em>{\mathbf{x}}[f(x)] + \beta \mathbb{E}_{\mathbf{x}}[g(x)] ,
$$
when $\alpha$ and $\beta$ are not dependent on $x$.</p><p>The <strong>variance</strong> gives a measure of how much the values of a function of a random variable $\bf{x}$ vary as we sample different values of $x$ from its probability distribution:
$$
\tag{3.12}
\text{Var}(f(x)) = \mathbb{E}[(f(x) - \mathbb{E}[f(x)])^2] .
$$
When the variance is low, the values of $f(x)$ cluster near their expected value. The square root of the variance is known as the <strong>standard deviation</strong>.</p><p>The <strong>covariance</strong> gives some sense of how much two values are linearly related to each other, as well as the scale of these variables:
$$
\tag{3.13}
\text{Cov}(f(x), g(y)) = \mathbb{E} \bigg[\big(
f(x) - \mathbb{E}[f(x)])\ (g(y) - \mathbb{E}[g(y)]
\big)\bigg] .
$$
High absolute values of the covariance mean that the values change very much and are both far from their respective means at the same time.</p><ul><li>If the sign of the covariance is positive, both variables tend to take on relatively high values simultaneously,</li><li>If the sign of the covariance is negative, one variable tend to take on relatively high values and the other takes on a relatively low values and vice versa.</li></ul><p>The notions of covariance and dependence are related but distinct concepts.</p><ul><li>Two independent variables have zero covariance, and two variables have nonzero covariance are dependent.</li><li>Zero covariance means there must be no linear dependence, While independent also excludes nonlinear relationships between two variables.</li><li>It is possible for two variables to be dependent but have zero covariance.</li></ul><p>The <strong>covariance matrix</strong> of a random vector $x \in \R^n$ is an $n \times n$ matrix, such that
$$
\tag{3.14}
\text{Cov}(\mathbf{x})_{i, j} = \text{Cov}(\mathbf{x}_i, \mathbf{x}_j) .
$$
The diagonal elements of the covariance give the variance:
$$
\tag{3.15}
\text{Cov}(\mathbf{x}_i, \mathbf{x}_i) = \text{Var}(\mathbf{x}_i) .
$$</p><h3 id=common-probability-distribution><div><a href=#common-probability-distribution>##
</a>Common Probability Distribution</div></h3><h4 id=bernoulli-distribution><div><a href=#bernoulli-distribution>###
</a>Bernoulli Distribution</div></h4><p>The Bernoulli Distribution is a distribution over a single binary random variable. It is controlled by a single parameter $\phi \in [0, 1]$, which gives the probability of the random variable being equal to $1$. It has the following properties:
$$
\begin{eqnarray}
\tag{3.16}
P(\mathbf{x} = 1) &=& \phi \
\
\tag{3.17}
P(\mathbf{x} = 0) &=& 1 - \phi \
\
\tag{3.18}
P(\mathbf{x} = x) &=& \phi^{x} (1 - \phi)^{1-x} \
\
\tag{3.19}
\mathbb{E}<em>\mathbf{x}[\mathbf{x}] &=& \phi \
\
\tag{3.20}
\text{Var}</em>\mathbf{x}(\mathbf{x}) &=& \phi (1 - \phi)
\end{eqnarray}
$$</p><h4 id=gaussian-distribution><div><a href=#gaussian-distribution>###
</a>Gaussian Distribution</div></h4><p>The most commonly used distribution over real numbers is the normal distribution, also known as the Gaussian distribution:
$$
\tag{3.21}
\mathcal{N}(x; \mu, \sigma^2) = \sqrt{{1 \over {2 \pi \sigma^2}}} \exp \bigg(-{1 \over {2 \sigma^2}} (x - \mu)^2 \bigg).
$$
The two parameters $\mu \in \R$ and $\sigma \in (0, \infin)$ control the normal distribution.</p><p>When we evaluate the PDF, we need to square and invert $\sigma$. When we need to frequently evaluate the PDF with different parameter values, a more efficient way of parametrizing the distribution is to use a parameter $\beta \in (0, \infin)$ to control the <strong>precision</strong>, or inverse variance, of the distribution:
$$
\tag{3.22}
\mathcal{N}(x; \mu, \beta^{-1}) = \sqrt{{\beta \over {2 \pi}}} \exp \bigg(-{1 \over 2} \beta (x - \mu)^2 \bigg).
$$
<img alt="bell curve" src=./images/DL_gaussian_distribution.png></p><p>Normal distributions are a sensible choice for many applications, for two major reasons:</p><ul><li>First, many distributions we wish to model are truly close to being normal distributions. The <strong>central limit theorem</strong> shows that the sum of many independent random variables is approximately normally distributed. This means that in practice, many complicated systems can be modeled successfully as normally distributed noise, even if the system can be decomposed into parts with more structured behavior.</li><li>Second, out of all possible probability distributions with the same variance, the normal distribution encodes the maximum amount of uncertainty over the real numbers. We can thus think of the normal distribution as being the one that inserts the least amount of prior knowledge into a model.</li></ul><p>The normal distribution generalizes to $\R^n$, in which case it is known as the <strong>multivariate normal distribution</strong>. It may be parametrized with a positive definite symmetric matrix $\Sigma$ :
$$
\tag{3.23}
\mathcal{N}(x; \mu, \Sigma) = \sqrt{{1 \over {(2 \pi)^n |\Sigma|}}}
\exp \bigg(-{1 \over 2} (x - \mu)^{\mathsf{T}} \Sigma^{-1} (x - \mu) \bigg).
$$
The parameter $\mu$ still gives the mean of the distribution, though now it is vector valued. The parameter $\Sigma$ gives the covariance matrix of the distribution. $|\Sigma|$ denotes the <strong>determinant</strong> of $\Sigma$ .</p><p>As in the univariate case, when we wish to evaluate the PDF multiple times with more efficient computation, we need to invert $\Sigma$ , and instead use a <strong>precision matrix $\beta$</strong> :
$$
\tag{3.24}
\mathcal{N}(x; \mu, \beta^{-1}) = \sqrt{{|\beta| \over (2 \pi)^n}} \exp \bigg(-{1 \over 2} (x - \mu)^{\mathsf{T}} \beta (x - \mu) \bigg).
$$
We often fix the covariance matrix to be a diagonal matrix. An even simpler version is the <strong>isotropic</strong> Gaussian distribution, whose covariance matrix is a scalar times the identity matrix.</p><h4 id=exponential-and-laplace-distributions><div><a href=#exponential-and-laplace-distributions>###
</a>Exponential and Laplace Distributions</div></h4><p>In the context of deep learning, we often want to have a probability distribution with a sharp point at $x = 0$. To accomplish this, we can use the <strong>exponential distribution</strong>:
$$
\tag{3.25}
p(x; \lambda) = \lambda \mathbf{1}<em>{x \ge 0} \exp(- \lambda x) .
$$
The exponential distribution uses the <strong>indicator function</strong> $\mathbf{1}</em>{x \ge 0}$ to assign probability zero to all negative values of $x$.</p><p>A closely related probability distribution that allows us to place a sharp peak of probability mass at an arbitrary point $\mu$ is the <strong>Laplace distribution</strong>
$$
\tag{3.26}
\text{Laplace}(x; \mu, \gamma) = {1 \over 2\gamma} \exp(- {|x - \mu| \over \gamma}).
$$</p><h2 id=information-theory><div><a href=#information-theory>#
</a>Information Theory</div></h2><p>Information theory is a branch of applied mathematics that resolves around quantifying how much information is present in a signal. In the context of machine learning, we can apply information theory to characterize probability distributions or quantify similarity between probability distributions.</p><p>The basic intuition behind information theory is that learning that an unlikely event has has occurred is more informative than learning that a likely event has occurred. A message saying &ldquo;the sun rose this morning&rdquo; is so uninformative (to human being on the earth) as to be unnecessary to send, but a message saying &ldquo;there are a solar eclipse this morning&rdquo; is very informative.</p><p>We would like to quantify information in a way that formalizes this intuition.</p><ul><li>Likely events should have low information content, and in the extreme case, events that are guaranteed to happen should have no information content whatsoever.</li><li>Less likely events should have higher information content.</li><li>Independent events should have additive information. For example, finding out that a tossed coin has come up as heads twice should convey twice as much information as finding out that a tossed coin has come up as head once.</li></ul><p>To satisfy all three of these properties, we define the <strong>self-information</strong> of an event $\mathbf{x} = x$ to be
$$
\tag{3.48}
I(x) = - \log P(x) .
$$
In this series, we always use log to mean the natural logarithm, with base $e$. Our definition of $I(x)$ is therefore written in units of <strong>nats</strong>. One nat is the amount of information gained by observing an event of probability $1 \over e$. Other texts use base-2 logarithms and units called <strong>bits</strong> or <strong>shannons</strong>; information measured in bits is just a rescaling of information measured in nats.</p><p>When $\bf{x}$ is continuous, an event with unit density still has zero information, despite not being an event that is guaranteed to occur.</p><h3 id=entropy><div><a href=#entropy>##
</a>Entropy</div></h3><p>Self-information deals only with a single outcome. We can quantify the amount of uncertainty in an entire probability distribution using the <strong>Shannon entropy</strong>,
$$
\tag{3.49}
H(\mathbf{x})
= \mathbb{E}<em>{\mathbf{x} \sim P}[I(x)]
= - \mathbb{E}</em>{\mathbf{x} \sim P}[\log P(x)],
$$
also denoted $H(P)$. In other words, the Shannon entropy of a distribution is the expected amount of information in an event drawn from that distribution. It gives a lower bound on the number of nats needed on average to encode symbols drawn from a distribution $P$. Distributions that are nearly deterministic (where outcome is nearly certain) have low entropy; distributions that are closer to uniform have high entropy. When $\bf{x}$ is continuous, the Shannon entropy is known as the <strong>differential entropy</strong>.</p><p><img alt="Shannon entropy" src=./images/DL_binary_Shannon_entropy.png></p><h3 id=kl-divergence><div><a href=#kl-divergence>##
</a>KL divergence</div></h3><p>If we have two separate probability distributions $P(x)$ and $Q(x)$ over the same random variable $\bf{x}$, we can measure how different these two distributions are using the <strong>Kullback-Leibler (KL) divergence</strong>:
$$
\tag{3.50} \label{eq_kld}
D_{KL}(P || Q)
= \mathbb{E}<em>{\mathbf{x} \sim P} \bigg[\log {P(x) \over Q(x)} \bigg]
= \mathbb{E}</em>{\mathbf{x} \sim P}[\log P(x) - \log Q(x)] .
$$</p><p>In the case of discrete variables, it is the extra amount of information (in bits or nats) needed to send a message containing symbols drawn from probability distribution $P$, when we use a code that was designed to minimize the length of messages drawn from probability distribution $Q$.</p><p>The KL divergence has many useful properties, most notably being non-negative. The KL divergence is $0$ if and only if $P$ and $Q$ are the same distribution in the case of discrete variables, or equal &ldquo;almost everywhere<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>&rdquo; in the case of continuous variables. Because the KL divergence is non-negative and measures the difference between two distributions, it is often conceptualized as measuring some sort of distance between these distributions. It is not a true distance measure because it is not symmetric: $D_{KL}(P || Q) \ne D_{KL}(Q || P)$ for some $P$ and $Q$. This asymmetriy means that there are important consequences to the choice of whether to use $D_{KL}(P || Q)$ or $D_{KL}(Q || P)$. See figure 3.6 for more detail.</p><p><img alt="KL divergence" src=./images/DL_kl_divergence.png></p><p>A quantity that is closely related to the KL divergence is the <strong>cross-entropy</strong> $H(P, Q) = H(P) + D_{KL}(P||Q)$, which is similar to the KL divergence ($\ref{eq_kld}$) but lacking the term on the left:
$$
\tag{3.51}
H(P, Q) = - \mathbb{E}_{\mathbf{x} \sim P} \log Q(x) .
$$
Minimizing the cross-entropy with respect to $Q$ is equivalent to minimizing the KL divergence, because $Q$ does not participate in the omitted term.</p><p>When computing many of these quantities, it is common to encounter expressions of the form $0\log0$. By convention, in the context of information theory, we treat these expressions as $\lim_{x \rightarrow 0} x \log x = 0$.</p><h3 id=kl-散度><div><a href=#kl-%e6%95%a3%e5%ba%a6>##
</a>KL 散度</div></h3><p>KL 散度，也称为相对熵(relative entropy)或信息散度(information divergence)，可用于度量两个概率分布之间的差异。给定两个(连续型)概率分布 $P$ 和 $Q$ ，二者之间的 KL 散度定义为
$$
\tag{C.34}
KL(P||Q) = \int^{\infin}_{-\infin} p(x) \log {p(x) \over q(x)} dx,
$$
其中，$p(x)$ 和 $q(x)$ 分别为 $P$ 和 $Q$ 的概率密度函数。KL 散度满足非负性，但不满足对称性，因此 KL 散度不是一个度量(metric)<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>。</p><p>若将 KL 散度的定义展开，可得
$$
\begin{eqnarray}
KL(P||Q)
&=& \int^{\infin}<em>{-\infin} p(x) \log {p(x)} dx - \int^{\infin}</em>{-\infin} p(x) \log {q(x)} dx \
\
\tag{C.37}
&=& -H(P) + H(P,Q)
\end{eqnarray}
$$
其中，$H(P)$ 为熵(entropy)，$H(P,Q)$ 为 $P$ 和 $Q$ 得交叉熵(cross-entropy)。在信息论中，熵 $H(P)$ 表示对来自 $P$ 的随机变量进行编码所需要的最小字节数，而交叉熵 $H(H,Q)$ 则表示使用基于 $Q$ 的编码对来自 $P$ 的变量进行编码所需要的 “额外” 的字节数；显然，额外字节数必然非负，当且仅当 $P = Q$ 时额外字节数为零。</p><h2 id=density-estimation><div><a href=#density-estimation>#
</a>Density Estimation</div></h2><h3 id=histogram><div><a href=#histogram>##
</a>Histogram</div></h3><blockquote><p>&ldquo;In a (standard) histogram, the areas of the blocks represent percentages.&rdquo;</p><p>&ldquo;With the density scale on the vertical axis, the areas of the blocks come out in percent. The area under the histogram over an interval equals the percentage of cases in that interval. The total area under the histogram is 100%.&rdquo;</p></blockquote><p>A <strong>histogram</strong> is a plot designed to show the distribution of values in a set of data. The values are first sorted, and then divided into a fixed number of equal-width bins. A plot is then drawn that shows the number of elements in each bin. (Note that the histograms in Figure 15.20 were not turn the counts into normalized probability density.)</p><p><img alt=histograms src=./images/ICPP_histograms_coin_flips.png></p><p>A histogram is a depiction of a <strong>frequency distribution</strong>. It tells us how often a random variable has taken on a value in some range, e.g., how often the fraction of times a coin came up heads was between 0.4 and 0.5. It also provides information about the relative frequency of various ranges. For example, we can easily see that the fraction of heads falls between 0.4 and 0.5 far more frequently than it falls between 0.3 and 0.4 (see the one in the left in Figure 15.20). Notice that while the means in both plots (Figure 15.20) are about the same, the standard deviations are quite different. The spread of outcomes is much tighter when we flip the coin 1000 times per trail than when we flip the coin 100 times per trial<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><p>A <strong>probability distribution</strong> captures the notion of relative frequency by giving the probability of a random value taking on a value within a range. Probability distributions fall into two groups: discrete probability distributions and continuous probability distributions, depending upon whether they define the probability distribution for a discrete or a continuous random variable.</p><p><strong>Discrete probability distributions</strong> are easier to describe. Since there are a finite number of values that the variable can take on, the distribution can be described by simply listing the probability of each value.</p><p><strong>Continuous probability distributions</strong> are trickier. Since there are an infinite number of possible values, the probability that a continuous random variable will take on a specific value is usually 0. For example, the probability that a car is traveling at exactly 81.3457283 miles per hour is probably 0. Mathematicians like to describe continuous probability distributions using a <strong>Probability Density Function (PDF)</strong>. A <strong>PDF</strong> describes the probability of a random variable lying between two values. Think of the PDF as defining a curve where the values on the x-axis lie between the minimum and maximum value of the random variable. Under the assumption that $x_1$ and $x_2$ lie in the domain of the random variable, the probability of the variable having a value between $x_1$ and $x_2$ is the area under the PDF curve between $x_1$ and $x_2$ .</p><p><img alt=pdf src=./images/ICPP_probability_density_functions.png></p><p>The <code>random.random()</code> returns a value lies in interval [0, 1]. The area under the curve of PDF for <code>random.random()</code> from 0 to 1 is 1. On the other hand, if we consider the area under the part of the curve between 0.2 and 0.4, it is 0.2 ($(0.4 - 0.2) \times 1.00$). Similarly, the area under the curve for <code>random.random()+random.random()</code> from 0 to 2 is also 1, and the area under the curve from 0 to 1 is 0.5. Notice that the same length of interval has the same probability in PDF for <code>random.random()</code> while some intervals are more probable than others in PDF for <code>random.random()+random.random()</code>.</p><h3 id=histogram-for-density-estimation><div><a href=#histogram-for-density-estimation>##
</a>Histogram for density estimation</div></h3><p>Density estimation can be used of probability distributions (such Gaussian, Beta, Dirichlet distributions) having specific functional forms governed by a small number of parameters whose values are to be determined from a data set. This is called the <em>parametric</em> approach to density modeling. An important limitation of this approach is that the chosen density might be a poor model of the distribution that generates the data, which can result in poor predictive performance. For instance, if the process that generates the data is multimodal (多峰的), then this aspect of the distribution can never be captured by a Gaussian, which is necessarily unimodal<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>.</p><p>We consider some <em>nonparametric</em> approaches to density estimation that make few assumptions about the form of the distribution. Here we focus mainly on simple frequentist methods. Let&rsquo;s start with a discussion of histogram methods for density estimation, we explore the properties of histogram density model, focusing on the case of a single continuous variable $x$.</p><p>Standard histograms simply partition $x$ into distinct bins of with $\Delta_i$ and then count the number $n_i$ of observations of $x$ falling in bin $i$. In order to turn this count into a normalized probability density, we simply divide by the total number $N$ of observations and by the width $\Delta_i$ of the bins to obtain probability values for each bin given by
$$
\tag{2.241}
p_i = \frac{n_i}{N \Delta_i}
$$
for which it is easily seen that $\int p(x)dx = 1$. This gives a model for the density $p(x)$ that is constant over the width of each bin, and often the bins are chosen to have the same width $\Delta_i = \Delta$.</p><p><img alt="histogram models" src=./images/PRML_histogram_models.png></p><p>From above figure, we can see that</p><ul><li>when $\Delta$ is very small (top right), the resulting density model is very spiky (lost a lot of structure of underlying distribution),</li><li>if $\Delta$ is too large (bottom right), the result is a model that is too smooth (fails to capture the bimodal property of the green curve).</li></ul><p>The best results are obtained for some intermediate value of $\Delta$ (middle right). In principle, a histogram density model is also dependent on the choice of edge location for the bins, though this is typically much less significant than the value of $\Delta$.</p><p>Note that the histogram method has the property that once the histogram has been computed, the data set itself can be discarded, which can be advantageous if the data set is large. Also, the histogram approach is easily applied if the data points are arriving sequentially.</p><p>In practice, the histogram technique can be useful for obtaining a quick visualization of data in one or two dimensions but is unsuited to most density estimation applications. The limitations are</p><ul><li>the estimated density has discontinuities that are due to the bin edges,</li><li>in a space of high dimensionality, the number of bins (M) are exponential scaling with the number of dimension (D), which is $M^D$. The quantity of data needed to provide meaningful estimates of local probability density would be prohibitive.</li></ul><p>Two widely used nonparametric techniques for density estimation, <strong>kernel estimators</strong> and <strong>nearest neighbors</strong>, which have better scaling with dimensionality than the simple histogram model.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>technical view of continuous variables [more advance mathematics knowledge required].&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>度量(metric)应满足四个基本性质：非负性($dist(x_i,x_j) \ge 0$)；同一性($dist(x_i, x_j)=0 \iff x_i=x_j$)；对称性($dist(x_i, x_j) = dist(x_j, x_i)$)；直递性($dist(x_i, x_j) \le dist(x_i, x_k) + dist(x_k, x_j)$)&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Recall that this is also an example of the law of the average.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Consider Gaussian Mixture Models in this case.&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><h3 class="read-next-title noselect"></h3><ul class="read-next-posts noselect"><li><a href=/posts/ml101/treebasedmodels/deepforest/>Book Notes: Deep-Forest Model</a></li><li><a href=/posts/ml101/treebasedmodels/treemodels/>Book Notes: Tree-based Models</a></li></ul><div class="pagination post-pagination"><div class="left pagination-item"><a href=/posts/neuralnetworks/xgsbackprop/>西瓜书_误差逆传播算法(BP)</a></div><div class="right pagination-item"><a href=/posts/ml101/clusteringmethods/semi-supervised_clustering/>Book Notes: semi-supervised clustering methods</a></div></div></main><footer class="common-footer noselect"><ul class=language-select><li>Chinese</li><li><a href=/en/>English</a></li></ul><div class=common-footer-bottom><div style=display:flex;align-items:center;gap:8px>© fmh, 2024</div><div style=display:flex;align-items:center></div><div><a target=_blank rel="noopener noreferrer" href=https://gohugo.io/>Hugo</a>, <a target=_blank rel="noopener noreferrer" href=https://github.com/Junyi-99/hugo-theme-anubis2>Anubis2</a>.<br></div></div><p class="h-card vcard"><a href=https://fgg100y.github.io/ class="p-name u-url url fn" rel=me>map[email:1522009317@qq.com name:fmh]</a></p></footer></div></body></html>